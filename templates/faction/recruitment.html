{% extends 'base.html' %}

{% block title %}
Tornium - Faction Recruitment
{% endblock %}

{% block content %}

{% include 'navbar.html' %}
{% include 'faction/navbar.html' %}

<div class="px-3 py-3">
    <div class="card">
        <div class="card-body">
            <h5 class="card-title">Faction Recruitment (In-Dev)</h5>
            <h6>
                <b>WARNING:</b> This feature is currently in development, therefore certain sub-features may not be fully
                operational. Contact tiksan for more details.
            </h6>

            <p class="card-text">
                This feature will track recruiters added to the list of recruitment people for recruitment messages
                sent, members invited, members joined, members retained, and more.
            </p>

            <p class="card-text">
                <b>NOTE:</b> This feature requires the
                <a href="https://gist.github.com/dssecret/a953233fc3e3870312e93577601faf88" target="_blank" rel="noopener noreferrer">
                    Tornium Recruitment userscript
                </a> to be installed.
            </p>
        </div>
    </div>

    {% if current_user.recruiter %}
    <div class="card mt-3">
        <div class="card-body">
            <h5 class="card-title">Recruiter Information</h5>

            <div class="row">
                <div class="col-sm-12 col-md-8 col-lg-4">
                    <div class="card mt-3">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item">
                                Code: <span id="recruiter-code">{{ recruiter_code }}</span>
                            </li>
                            <li class="list-group-item">
                                Messages Sent: {{ recruiter_sent }} message(s)
                            </li>
                            <li class="list-group-item">
                                Members Invited: {{ recruiter_invited }} member(s)
                            </li>
                            <li class="list-group-item">
                                Members Joined: {{ recruiter_joined }} member(s)
                            </li>
                            <li class="list-group-item">
                                Members Retained (1 Week): {{ recruiter_retainedweek }} member(s)
                            </li>
                            <li class="list-group-item">
                                Members Retained (1 Month): {{ recruiter_retainedmonth }} member(s)
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <button type="button" class="btn btn-primary mt-3" id="recruiter-refresh-code">Refresh Recruiter Code</button>
        </div>
    </div>
    {% endif %}

    <div class="card mt-3">
        <div class="card-body">
            <h5 class="card-title">Faction Recruiters</h5>

            <table id="recruiters-table" class="table table-striped table-bordered responsive">
                <thead>
                    <tr>
                        <th>Recruiter</th>
                        <th>Messages Sent</th>
                        <th>Members Invited</th>
                        <th>Members Joined</th>
                        <th>Members Retained (1 Week)</th>
                        <th>Members Retained (1 Month)</th>
                    </tr>
                </thead>
                <tbody>

                </tbody>
            </table>

            {% if current_user.aa %}
            <div class="row">
                <div class="col-sm-12 col-md-8 col-lg-4 my-2">
                    <form class="form-floating" id="recruiter-add-form">
                        <input class="form-control" id="recruiter-tid" name="recruiter-tid">
                        <label for="recruiter-tid">Recruiter To Be Added</label>
                        <div class="form-text">
                            Please enter the Torn ID of the user you wish to add as a faction recruiter. They must be
                            a signed-in member of your current faction to be added.
                        </div>
                    </form>
                </div>

                <div class="col-sm-12 col-md-8 col-lg-4 my-2">
                    <form class="form-floating" id="recruiter-remove-form">
                        <input class="form-control" id="recruiter-remove-tid" name="recruiter-remove-tid">
                        <label for="recruiter-remove-tid">Recruiter To Be Removed</label>
                        <div class="form-text">
                            Please enter the Torn ID of the user you wish to remove as a faction recruiter. They must
                            be a signed-in member of your current faction to be added.
                        </div>
                    </form>
                </div>
            </div>
            {% endif %}
        </div>
    </div>

    <div class="card mt-3">
        <div class="card-body">
            <h5 class="card-title">Faction Recruits</h5>

            <table id="recruits-table" class="table table-striped table-bordered responsive">
                <thead>
                    <tr>
                        <th>Recruit ID</th>
                        <th>Recruit</th>
                        <th>Recruited By</th>
                        <th>Status</th>
                        <th>Messages Received</th>
                        <th>Time in Faction</th>
                    </tr>
                </thead>
                <tbody>

                </tbody>
            </table>

            <div class="row">
                <div class="col-sm-12 col-md-8 col-lg-4 my-2">
                    <form class="form-floating" id="recruit-invite-form">
                        <input class="form-control" id="recruit-tid" name="recruit-tid">
                        <label for="recruit-tid">Recruit To Be Invited</label>
                        <div class="form-text">
                            Please enter the Torn ID of the user you wish to invite to the faction. You must be the
                            user's recruiter to be invite the user.
                        </div>
                    </form>
                </div>

                <div class="col-sm-12 col-md-8 col-lg-4 my-2">
                    <form class="form-floating" id="recruit-remove-form">
                        <input class="form-control" id="recruit-remove-tid" name="recruit-remove-tid">
                        <label for="recruit-remove-tid">Recruit To Be Removed</label>
                        <div class="form-text">
                            Please enter the Torn ID of the user from whom you wish to remove the invite. You must be
                            the user's recruiter to be invite the user.
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="/faction/recruitment.js" data-key="{{ current_user.key }}"></script>
{% endblock %}
